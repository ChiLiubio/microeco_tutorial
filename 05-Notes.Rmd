# Notes
We show some important things here.

## clone
R6 class has a special copy mechanism which is different from S3 and S4.
If you want to copy an object completely, you should use the function clone() instead of direct assignment.

```{r, echo = TRUE}
# use clone to copy completely
t1 <- clone(dataset)
t2 <- clone(t1)
t2$sample_table <- NULL
identical(t2, t1)
```

```{r, echo = TRUE}
# this operation is usually unuseful, because changing t2 will also affect t1
t2 <- t1
t2$sample_table <- NULL
identical(t2, t1)
```


## add layers to plot
Most of the plots are generated by applying the ggplot2 package.
The important parameters in the plotting functions are configured according to our experience.
If the inner parameters can not enough, the user can add the layers to the plot like the following operation or
make the plot using the data (generally data.frame class) stored in the object.


```{r, echo = TRUE, eval = FALSE}
# The groupmean parameter can be used to obtain the group-mean barplot.
t1 <- trans_abund$new(dataset = dataset, taxrank = "Phylum", ntaxa = 10, groupmean = "Group")
g1 <- t1$plot_bar(others_color = "grey70", legend_text_italic = FALSE)
g1 + theme_classic() + theme(axis.title.y = element_text(size = 18))
```

```{r, out.width = "400px", fig.align="center", echo = FALSE}
knitr::include_graphics("Images/plot_bar_mean_classic.png")
```

## subset of samples
We donnot provide the special function to filter samples in microtable class, as we think it is redundant.
We recommend user to directly manipulate the sample_table in microtable object.
For example, if we want to analyze samples from 'CW' and 'IW', respectively, we can operate like this: 

```{r, echo = TRUE}
# remember first clone the full dataset
group1 <- clone(dataset)
group1$sample_table <- subset(group1$sample_table, Group == "CW")
# this is necessary to make files in group1 corresponding
group1$tidy_dataset()

# similar with obove operation
group2 <- clone(dataset)
group2$sample_table <- subset(group2$sample_table, Group == "IW")
group2$tidy_dataset()
# now we get two microtable objects: group1 for CW and group2 for IW
```

## change object
All the classes are set public, meaning that you can change, add or remove the objects stored in them as you want.

```{r, echo = TRUE}
# add a matrix you think useful
dataset$my_matrix <- matrix(1, nrow = 4, ncol = 4)
# change the information
dataset$sample_table %<>% .[, -2]
```

## customized taxonomic table
To meet the analysis of complicated cases with mixed taxonomic levels,
the cal_abund() function in microtable class supports the customized analysis on the selected levels or columns in tax_table and also
the selection of relative/absolute abundance.

```{r, echo = TRUE}
# see https://github.com/ChiLiubio/file2meco and help documents for more usages
dataset$cal_abund(select_cols = 1:3, rel = FALSE)
```



