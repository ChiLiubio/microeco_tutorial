<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 mecoturn package | Tutorial for R microeco package (v1.9.0)</title>
  <meta name="description" content="Examples for R microeco (v1.9.0), file2meco (v0.8.0), meconetcomp (v0.5.1) and mecoturn packages" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 mecoturn package | Tutorial for R microeco package (v1.9.0)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Examples for R microeco (v1.9.0), file2meco (v0.8.0), meconetcomp (v0.5.1) and mecoturn packages" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 mecoturn package | Tutorial for R microeco package (v1.9.0)" />
  
  <meta name="twitter:description" content="Examples for R microeco (v1.9.0), file2meco (v0.8.0), meconetcomp (v0.5.1) and mecoturn packages" />
  



<meta name="date" content="2024-08-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="mecodev-package.html"/>
<link rel="next" href="other-examples-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">microeco tutorial</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Background</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#framework"><i class="fa fa-check"></i><b>2.1</b> Framework</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#r6-class"><i class="fa fa-check"></i><b>2.2</b> R6 Class</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#help"><i class="fa fa-check"></i><b>2.3</b> Help</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#rtools"><i class="fa fa-check"></i><b>2.4</b> RTools</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#dependence"><i class="fa fa-check"></i><b>2.5</b> Dependence</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="intro.html"><a href="intro.html#description"><i class="fa fa-check"></i><b>2.5.1</b> Description</a></li>
<li class="chapter" data-level="2.5.2" data-path="intro.html"><a href="intro.html#cran-packages"><i class="fa fa-check"></i><b>2.5.2</b> CRAN packages</a></li>
<li class="chapter" data-level="2.5.3" data-path="intro.html"><a href="intro.html#bioconductor-packages"><i class="fa fa-check"></i><b>2.5.3</b> Bioconductor packages</a></li>
<li class="chapter" data-level="2.5.4" data-path="intro.html"><a href="intro.html#github-packages"><i class="fa fa-check"></i><b>2.5.4</b> Github packages</a></li>
<li class="chapter" data-level="2.5.5" data-path="intro.html"><a href="intro.html#gephi"><i class="fa fa-check"></i><b>2.5.5</b> Gephi</a></li>
<li class="chapter" data-level="2.5.6" data-path="intro.html"><a href="intro.html#tax4fun2"><i class="fa fa-check"></i><b>2.5.6</b> Tax4Fun2</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="intro.html"><a href="intro.html#plot"><i class="fa fa-check"></i><b>2.6</b> Plot</a></li>
<li class="chapter" data-level="2.7" data-path="intro.html"><a href="intro.html#rstudio"><i class="fa fa-check"></i><b>2.7</b> Rstudio</a></li>
<li class="chapter" data-level="2.8" data-path="intro.html"><a href="intro.html#citation"><i class="fa fa-check"></i><b>2.8</b> Citation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basic-class.html"><a href="basic-class.html"><i class="fa fa-check"></i><b>3</b> Basic class</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basic-class.html"><a href="basic-class.html#microtable-class"><i class="fa fa-check"></i><b>3.1</b> microtable class</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="basic-class.html"><a href="basic-class.html#prepare-the-example-data"><i class="fa fa-check"></i><b>3.1.1</b> Prepare the example data</a></li>
<li class="chapter" data-level="3.1.2" data-path="basic-class.html"><a href="basic-class.html#how-to-read-your-files-to-microtable-object"><i class="fa fa-check"></i><b>3.1.2</b> How to read your files to microtable object?</a></li>
<li class="chapter" data-level="3.1.3" data-path="basic-class.html"><a href="basic-class.html#functions-in-microtable-class"><i class="fa fa-check"></i><b>3.1.3</b> Functions in microtable class</a></li>
<li class="chapter" data-level="3.1.4" data-path="basic-class.html"><a href="basic-class.html#merge-taxa-or-samples"><i class="fa fa-check"></i><b>3.1.4</b> merge taxa or samples</a></li>
<li class="chapter" data-level="3.1.5" data-path="basic-class.html"><a href="basic-class.html#subset-of-samples"><i class="fa fa-check"></i><b>3.1.5</b> subset of samples</a></li>
<li class="chapter" data-level="3.1.6" data-path="basic-class.html"><a href="basic-class.html#subset-of-taxa"><i class="fa fa-check"></i><b>3.1.6</b> subset of taxa</a></li>
<li class="chapter" data-level="3.1.7" data-path="basic-class.html"><a href="basic-class.html#other-examples"><i class="fa fa-check"></i><b>3.1.7</b> Other examples</a></li>
<li class="chapter" data-level="3.1.8" data-path="basic-class.html"><a href="basic-class.html#key-points"><i class="fa fa-check"></i><b>3.1.8</b> Key points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="composition-based-class.html"><a href="composition-based-class.html"><i class="fa fa-check"></i><b>4</b> Composition-based class</a>
<ul>
<li class="chapter" data-level="4.1" data-path="composition-based-class.html"><a href="composition-based-class.html#trans_abund-class"><i class="fa fa-check"></i><b>4.1</b> trans_abund class</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="composition-based-class.html"><a href="composition-based-class.html#example"><i class="fa fa-check"></i><b>4.1.1</b> Example</a></li>
<li class="chapter" data-level="4.1.2" data-path="composition-based-class.html"><a href="composition-based-class.html#key-points-1"><i class="fa fa-check"></i><b>4.1.2</b> Key points</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="composition-based-class.html"><a href="composition-based-class.html#trans_venn-class"><i class="fa fa-check"></i><b>4.2</b> trans_venn class</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="composition-based-class.html"><a href="composition-based-class.html#example-1"><i class="fa fa-check"></i><b>4.2.1</b> Example</a></li>
<li class="chapter" data-level="4.2.2" data-path="composition-based-class.html"><a href="composition-based-class.html#key-points-2"><i class="fa fa-check"></i><b>4.2.2</b> Key points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="diversity-based-class.html"><a href="diversity-based-class.html"><i class="fa fa-check"></i><b>5</b> Diversity-based class</a>
<ul>
<li class="chapter" data-level="5.1" data-path="diversity-based-class.html"><a href="diversity-based-class.html#trans_alpha-class"><i class="fa fa-check"></i><b>5.1</b> trans_alpha class</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="diversity-based-class.html"><a href="diversity-based-class.html#example-2"><i class="fa fa-check"></i><b>5.1.1</b> Example</a></li>
<li class="chapter" data-level="5.1.2" data-path="diversity-based-class.html"><a href="diversity-based-class.html#key-points-3"><i class="fa fa-check"></i><b>5.1.2</b> Key points</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="diversity-based-class.html"><a href="diversity-based-class.html#trans_beta-class"><i class="fa fa-check"></i><b>5.2</b> trans_beta class</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="diversity-based-class.html"><a href="diversity-based-class.html#example-3"><i class="fa fa-check"></i><b>5.2.1</b> Example</a></li>
<li class="chapter" data-level="5.2.2" data-path="diversity-based-class.html"><a href="diversity-based-class.html#key-points-4"><i class="fa fa-check"></i><b>5.2.2</b> Key points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="model-based-class.html"><a href="model-based-class.html"><i class="fa fa-check"></i><b>6</b> Model-based class</a>
<ul>
<li class="chapter" data-level="6.1" data-path="model-based-class.html"><a href="model-based-class.html#trans_diff-class"><i class="fa fa-check"></i><b>6.1</b> trans_diff class</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="model-based-class.html"><a href="model-based-class.html#example-4"><i class="fa fa-check"></i><b>6.1.1</b> Example</a></li>
<li class="chapter" data-level="6.1.2" data-path="model-based-class.html"><a href="model-based-class.html#more-options"><i class="fa fa-check"></i><b>6.1.2</b> More options</a></li>
<li class="chapter" data-level="6.1.3" data-path="model-based-class.html"><a href="model-based-class.html#key-points-5"><i class="fa fa-check"></i><b>6.1.3</b> Key points</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="model-based-class.html"><a href="model-based-class.html#trans_network-class"><i class="fa fa-check"></i><b>6.2</b> trans_network class</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="model-based-class.html"><a href="model-based-class.html#example-5"><i class="fa fa-check"></i><b>6.2.1</b> Example</a></li>
<li class="chapter" data-level="6.2.2" data-path="model-based-class.html"><a href="model-based-class.html#network-comparison"><i class="fa fa-check"></i><b>6.2.2</b> Network comparison</a></li>
<li class="chapter" data-level="6.2.3" data-path="model-based-class.html"><a href="model-based-class.html#key-points-6"><i class="fa fa-check"></i><b>6.2.3</b> Key points</a></li>
<li class="chapter" data-level="6.2.4" data-path="model-based-class.html"><a href="model-based-class.html#other-functions"><i class="fa fa-check"></i><b>6.2.4</b> Other functions</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="model-based-class.html"><a href="model-based-class.html#trans_nullmodel-class"><i class="fa fa-check"></i><b>6.3</b> trans_nullmodel class</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="model-based-class.html"><a href="model-based-class.html#example-6"><i class="fa fa-check"></i><b>6.3.1</b> Example</a></li>
<li class="chapter" data-level="6.3.2" data-path="model-based-class.html"><a href="model-based-class.html#key-points-7"><i class="fa fa-check"></i><b>6.3.2</b> Key points</a></li>
<li class="chapter" data-level="6.3.3" data-path="model-based-class.html"><a href="model-based-class.html#other-function"><i class="fa fa-check"></i><b>6.3.3</b> Other function</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="model-based-class.html"><a href="model-based-class.html#trans_classifier-class"><i class="fa fa-check"></i><b>6.4</b> trans_classifier class</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="model-based-class.html"><a href="model-based-class.html#dependencies"><i class="fa fa-check"></i><b>6.4.1</b> Dependencies</a></li>
<li class="chapter" data-level="6.4.2" data-path="model-based-class.html"><a href="model-based-class.html#examples"><i class="fa fa-check"></i><b>6.4.2</b> Examples</a></li>
<li class="chapter" data-level="6.4.3" data-path="model-based-class.html"><a href="model-based-class.html#key-points-8"><i class="fa fa-check"></i><b>6.4.3</b> Key points</a></li>
<li class="chapter" data-level="6.4.4" data-path="model-based-class.html"><a href="model-based-class.html#other-function-1"><i class="fa fa-check"></i><b>6.4.4</b> Other function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="explainable-class.html"><a href="explainable-class.html"><i class="fa fa-check"></i><b>7</b> Explainable class</a>
<ul>
<li class="chapter" data-level="7.1" data-path="explainable-class.html"><a href="explainable-class.html#trans_env-class"><i class="fa fa-check"></i><b>7.1</b> trans_env class</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="explainable-class.html"><a href="explainable-class.html#example-7"><i class="fa fa-check"></i><b>7.1.1</b> Example</a></li>
<li class="chapter" data-level="7.1.2" data-path="explainable-class.html"><a href="explainable-class.html#key-points-9"><i class="fa fa-check"></i><b>7.1.2</b> Key points</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="explainable-class.html"><a href="explainable-class.html#trans_func-class"><i class="fa fa-check"></i><b>7.2</b> trans_func class</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="explainable-class.html"><a href="explainable-class.html#example-8"><i class="fa fa-check"></i><b>7.2.1</b> Example</a></li>
<li class="chapter" data-level="7.2.2" data-path="explainable-class.html"><a href="explainable-class.html#key-points-10"><i class="fa fa-check"></i><b>7.2.2</b> Key points</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="file2meco-package.html"><a href="file2meco-package.html"><i class="fa fa-check"></i><b>8</b> file2meco package</a>
<ul>
<li class="chapter" data-level="8.1" data-path="file2meco-package.html"><a href="file2meco-package.html#qiime"><i class="fa fa-check"></i><b>8.1</b> QIIME</a></li>
<li class="chapter" data-level="8.2" data-path="file2meco-package.html"><a href="file2meco-package.html#qiime2"><i class="fa fa-check"></i><b>8.2</b> QIIME2</a></li>
<li class="chapter" data-level="8.3" data-path="file2meco-package.html"><a href="file2meco-package.html#humann"><i class="fa fa-check"></i><b>8.3</b> HUMAnN</a></li>
<li class="chapter" data-level="8.4" data-path="file2meco-package.html"><a href="file2meco-package.html#metaphlan"><i class="fa fa-check"></i><b>8.4</b> MetaPhlAn</a></li>
<li class="chapter" data-level="8.5" data-path="file2meco-package.html"><a href="file2meco-package.html#kraken2bracken"><i class="fa fa-check"></i><b>8.5</b> Kraken2/Bracken</a></li>
<li class="chapter" data-level="8.6" data-path="file2meco-package.html"><a href="file2meco-package.html#ncycdbpcycdb"><i class="fa fa-check"></i><b>8.6</b> NCycDB/PCycDB</a></li>
<li class="chapter" data-level="8.7" data-path="file2meco-package.html"><a href="file2meco-package.html#phyloseq"><i class="fa fa-check"></i><b>8.7</b> phyloseq</a></li>
<li class="chapter" data-level="8.8" data-path="file2meco-package.html"><a href="file2meco-package.html#picrust2"><i class="fa fa-check"></i><b>8.8</b> PICRUSt2</a></li>
<li class="chapter" data-level="8.9" data-path="file2meco-package.html"><a href="file2meco-package.html#viromescan"><i class="fa fa-check"></i><b>8.9</b> ViromeScan</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="other-dataset.html"><a href="other-dataset.html"><i class="fa fa-check"></i><b>9</b> Other dataset</a>
<ul>
<li class="chapter" data-level="9.1" data-path="other-dataset.html"><a href="other-dataset.html#fungi-data"><i class="fa fa-check"></i><b>9.1</b> Fungi data</a></li>
<li class="chapter" data-level="9.2" data-path="other-dataset.html"><a href="other-dataset.html#metagenomic-data"><i class="fa fa-check"></i><b>9.2</b> Metagenomic data</a></li>
<li class="chapter" data-level="9.3" data-path="other-dataset.html"><a href="other-dataset.html#gut-microbiome"><i class="fa fa-check"></i><b>9.3</b> Gut microbiome</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="notes.html"><a href="notes.html"><i class="fa fa-check"></i><b>10</b> Notes</a>
<ul>
<li class="chapter" data-level="10.1" data-path="notes.html"><a href="notes.html#clone-function"><i class="fa fa-check"></i><b>10.1</b> <code>clone</code> function</a></li>
<li class="chapter" data-level="10.2" data-path="notes.html"><a href="notes.html#save-function"><i class="fa fa-check"></i><b>10.2</b> <code>save</code> function</a></li>
<li class="chapter" data-level="10.3" data-path="notes.html"><a href="notes.html#github-issues"><i class="fa fa-check"></i><b>10.3</b> Github Issues</a></li>
<li class="chapter" data-level="10.4" data-path="notes.html"><a href="notes.html#group-order"><i class="fa fa-check"></i><b>10.4</b> group order</a></li>
<li class="chapter" data-level="10.5" data-path="notes.html"><a href="notes.html#add-layers-to-plot"><i class="fa fa-check"></i><b>10.5</b> add layers to plot</a></li>
<li class="chapter" data-level="10.6" data-path="notes.html"><a href="notes.html#colors-for-more-groups"><i class="fa fa-check"></i><b>10.6</b> colors for more groups</a></li>
<li class="chapter" data-level="10.7" data-path="notes.html"><a href="notes.html#change-object"><i class="fa fa-check"></i><b>10.7</b> change object</a></li>
<li class="chapter" data-level="10.8" data-path="notes.html"><a href="notes.html#customized-data-input"><i class="fa fa-check"></i><b>10.8</b> customized data input</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="meconetcomp-package.html"><a href="meconetcomp-package.html"><i class="fa fa-check"></i><b>11</b> meconetcomp package</a>
<ul>
<li class="chapter" data-level="11.1" data-path="meconetcomp-package.html"><a href="meconetcomp-package.html#network-modularity-for-all-networks"><i class="fa fa-check"></i><b>11.1</b> Network modularity for all networks</a></li>
<li class="chapter" data-level="11.2" data-path="meconetcomp-package.html"><a href="meconetcomp-package.html#network-topological-attributes-for-all-networks"><i class="fa fa-check"></i><b>11.2</b> Network topological attributes for all networks</a></li>
<li class="chapter" data-level="11.3" data-path="meconetcomp-package.html"><a href="meconetcomp-package.html#node-and-edge-properties-extraction-for-all-networks"><i class="fa fa-check"></i><b>11.3</b> Node and edge properties extraction for all networks</a></li>
<li class="chapter" data-level="11.4" data-path="meconetcomp-package.html"><a href="meconetcomp-package.html#compare-nodes-across-networks"><i class="fa fa-check"></i><b>11.4</b> Compare nodes across networks</a></li>
<li class="chapter" data-level="11.5" data-path="meconetcomp-package.html"><a href="meconetcomp-package.html#compare-edges-across-networks"><i class="fa fa-check"></i><b>11.5</b> Compare edges across networks</a></li>
<li class="chapter" data-level="11.6" data-path="meconetcomp-package.html"><a href="meconetcomp-package.html#extract-overlapped-edges-of-networks-to-a-new-network"><i class="fa fa-check"></i><b>11.6</b> Extract overlapped edges of networks to a new network</a></li>
<li class="chapter" data-level="11.7" data-path="meconetcomp-package.html"><a href="meconetcomp-package.html#compare-phylogenetic-distances-of-paired-nodes-in-edges"><i class="fa fa-check"></i><b>11.7</b> Compare phylogenetic distances of paired nodes in edges</a></li>
<li class="chapter" data-level="11.8" data-path="meconetcomp-package.html"><a href="meconetcomp-package.html#compare-node-sources-of-edges-across-networks"><i class="fa fa-check"></i><b>11.8</b> Compare node sources of edges across networks</a></li>
<li class="chapter" data-level="11.9" data-path="meconetcomp-package.html"><a href="meconetcomp-package.html#compare-topological-properties-of-sub-networks"><i class="fa fa-check"></i><b>11.9</b> Compare topological properties of sub-networks</a></li>
<li class="chapter" data-level="11.10" data-path="meconetcomp-package.html"><a href="meconetcomp-package.html#robustness-of-network"><i class="fa fa-check"></i><b>11.10</b> Robustness of network</a></li>
<li class="chapter" data-level="11.11" data-path="meconetcomp-package.html"><a href="meconetcomp-package.html#vulnerability-of-nodes"><i class="fa fa-check"></i><b>11.11</b> Vulnerability of nodes</a></li>
<li class="chapter" data-level="11.12" data-path="meconetcomp-package.html"><a href="meconetcomp-package.html#cohesion"><i class="fa fa-check"></i><b>11.12</b> Cohesion</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="mecodev-package.html"><a href="mecodev-package.html"><i class="fa fa-check"></i><b>12</b> mecodev package</a>
<ul>
<li class="chapter" data-level="12.1" data-path="mecodev-package.html"><a href="mecodev-package.html#trans_rarefy"><i class="fa fa-check"></i><b>12.1</b> trans_rarefy</a></li>
<li class="chapter" data-level="12.2" data-path="mecodev-package.html"><a href="mecodev-package.html#trans_ts"><i class="fa fa-check"></i><b>12.2</b> trans_ts</a></li>
<li class="chapter" data-level="12.3" data-path="mecodev-package.html"><a href="mecodev-package.html#trans_gamma"><i class="fa fa-check"></i><b>12.3</b> trans_gamma</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="mecoturn-package.html"><a href="mecoturn-package.html"><i class="fa fa-check"></i><b>13</b> mecoturn package</a>
<ul>
<li class="chapter" data-level="13.1" data-path="mecoturn-package.html"><a href="mecoturn-package.html#betaturn-class"><i class="fa fa-check"></i><b>13.1</b> betaturn class</a></li>
<li class="chapter" data-level="13.2" data-path="mecoturn-package.html"><a href="mecoturn-package.html#taxaturn-class"><i class="fa fa-check"></i><b>13.2</b> taxaturn class</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="other-examples-1.html"><a href="other-examples-1.html"><i class="fa fa-check"></i><b>14</b> Other examples</a>
<ul>
<li class="chapter" data-level="14.1" data-path="other-examples-1.html"><a href="other-examples-1.html#custom-taxa-order-in-bar-plot"><i class="fa fa-check"></i><b>14.1</b> Custom taxa order in bar plot</a></li>
<li class="chapter" data-level="14.2" data-path="other-examples-1.html"><a href="other-examples-1.html#tidy_taxonomy-function"><i class="fa fa-check"></i><b>14.2</b> tidy_taxonomy function</a></li>
<li class="chapter" data-level="14.3" data-path="other-examples-1.html"><a href="other-examples-1.html#show-the-abundance-of-unknown-taxa"><i class="fa fa-check"></i><b>14.3</b> Show the abundance of unknown taxa</a></li>
<li class="chapter" data-level="14.4" data-path="other-examples-1.html"><a href="other-examples-1.html#question-of-prefix-in-the-taxa"><i class="fa fa-check"></i><b>14.4</b> Question of prefix in the taxa</a></li>
<li class="chapter" data-level="14.5" data-path="other-examples-1.html"><a href="other-examples-1.html#the-use-of-phylogenetic-tree"><i class="fa fa-check"></i><b>14.5</b> The use of phylogenetic tree</a></li>
<li class="chapter" data-level="14.6" data-path="other-examples-1.html"><a href="other-examples-1.html#trans_norm"><i class="fa fa-check"></i><b>14.6</b> trans_norm</a></li>
<li class="chapter" data-level="14.7" data-path="other-examples-1.html"><a href="other-examples-1.html#mantel-test-correlation-heatmap"><i class="fa fa-check"></i><b>14.7</b> Mantel test + Correlation heatmap</a></li>
<li class="chapter" data-level="14.8" data-path="other-examples-1.html"><a href="other-examples-1.html#pcoa-boxplot"><i class="fa fa-check"></i><b>14.8</b> PCoA + boxplot</a></li>
<li class="chapter" data-level="14.9" data-path="other-examples-1.html"><a href="other-examples-1.html#faprotax-differential-test"><i class="fa fa-check"></i><b>14.9</b> FAPROTAX + differential test</a></li>
<li class="chapter" data-level="14.10" data-path="other-examples-1.html"><a href="other-examples-1.html#rda-results-output"><i class="fa fa-check"></i><b>14.10</b> RDA results output</a></li>
<li class="chapter" data-level="14.11" data-path="other-examples-1.html"><a href="other-examples-1.html#betanribetanti-for-each-group"><i class="fa fa-check"></i><b>14.11</b> betaNRI/betaNTI for each group</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Tutorial for R microeco package (v1.9.0)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mecoturn-package" class="section level1 hasAnchor" number="13">
<h1><span class="header-section-number">Chapter 13</span> mecoturn package<a href="mecoturn-package.html#mecoturn-package" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The mecoturn package is designed to study microbial turnover along plant compartments originally (<a href="https://github.com/ChiLiubio/mecoturn" class="uri">https://github.com/ChiLiubio/mecoturn</a>).
Generally speaking, it can be used in any case associated with a gradient.</p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="mecoturn-package.html#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mecoturn v0.3.0</span></span>
<span id="cb345-2"><a href="mecoturn-package.html#cb345-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;mecoturn&quot;</span>)</span>
<span id="cb345-3"><a href="mecoturn-package.html#cb345-3" aria-hidden="true" tabindex="-1"></a><span class="co"># check and install dependent packages</span></span>
<span id="cb345-4"><a href="mecoturn-package.html#cb345-4" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;agricolae&quot;</span>)</span>
<span id="cb345-5"><a href="mecoturn-package.html#cb345-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> packages){</span>
<span id="cb345-6"><a href="mecoturn-package.html#cb345-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(x, <span class="at">character.only =</span> <span class="cn">TRUE</span>)){</span>
<span id="cb345-7"><a href="mecoturn-package.html#cb345-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">install.packages</span>(x)</span>
<span id="cb345-8"><a href="mecoturn-package.html#cb345-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb345-9"><a href="mecoturn-package.html#cb345-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="betaturn-class" class="section level2 hasAnchor" number="13.1">
<h2><span class="header-section-number">13.1</span> betaturn class<a href="mecoturn-package.html#betaturn-class" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The betaturn class is used to study the turnover of communities, i.e. beta diversity along a gradient <span class="citation">(<a href="#ref-Anderson_Navigating_2011" role="doc-biblioref">Anderson et al. 2011</a>)</span>.
The pipeline consists of the steps of dissimilarity matrix generation, matrix conversion, differential test and visualization.
Creating betaturn object can generate the dissimilarity matrix stored in the object.
The example data <code>wheat_16S</code> is the amplicon sequencing data of 16S rDNA of wheat samples from different regions.
In <code>wheat_16S$sample_table</code>, the <code>Type</code> column represents the niches, i.e. plant compartments, including S (bulk soil), RS (rhizosphere soil) and R (root endophyte).
The <code>Plant_ID</code> column denotes each unique plant individual that the samples belong to.
The <code>Region</code> column means the sampling region of those plants.
Each region has five plant individuals.</p>
<p><img src="Images/mecoturn_betaturn.png" width="1000px" style="display: block; margin: auto;" /></p>
<p>Schematic diagrams of the framework in betaturn class.
In the flow chart,
Roman numeral represents the data for the input or output of associated step.
Arabic numeral within brackets denotes the step for the corresponding operation.
The workflow of betaturn class consists of the dissimilarity matrix generation, matrix conversion, differential test and visualization.
The core of the workflow is the matrix conversion, which can be classified into two cases (step 5 and 8) in the Figure.<br />
Ⅰ: Feature abundance table: microtable$otu_table object.
The microtable object can be created by the microtable class (R6 class) in microeco package.
The feature abundance table denotes the amplicon sequence variants (ASV) table or operational taxonomic units (OTU) abundance table in a study and should be data.frame format.<br />
Ⅱ: Phylogenetic tree: microtable$phylo_tree object.
It represents reconstructed phylogenetic tree based on the representative sequences and should be “phylo” format coming from read.tree function in ape package.
It is designed for calculating phylogenetic distance matrix of beta diversity,
such as mean nearest taxon distance (betaMNTD) and UniFrac metrics.<br />
Ⅲ: Sample information table: microtable$sample_table object. It is the sample metadata and must be data.frame format.
The ‘Type’ column represents plant compartments (including bulk soil) or other ordered groups used for the following comparison.
S: bulk soil; RS: rhizosphere soil; R: root endophyte.
The ‘Plant_ID’ column denotes each plant, by which the ordered distance transformation can be accomplished.<br />
Ⅳ: Dissimilarity matrix: symmetric distance matrix in betaturn$dataset$beta_diversity list.
The names of both the rows and columns of this symmetrical matrix are the sample names and they are correspondingly aligned as well.<br />
Ⅴ: Converted table: betaturn$res_group_distance object.
It is the output of function cal_group_distance of betaturn class with the parameter “within_group = FALSE”.
The table conversion is performed between any two samples of ‘Type’ column in Ⅲ,
but the combination of any two samples is constrained by the by_group parameter,
i.e. the conversion is only completed within the same plant according to ‘Plant_ID’ column of Ⅲ in the example,
which is one of the key features of the mecoturn package.
The converted distance table has a new ‘Type’ column as the combination of the elements in ‘Type’ column of original sample information table.
The ordered_group is designed optionally to sort the group order in the result.<br />
Ⅵ: Statistical analysis: betaturn$res_group_distance_diff object.
The approaches that used to compare means or medians across groups (i.e. groups in ‘Type’ column of Ⅲ)
are adapted from the cal_diff function of trans_alpha class in microeco package.
By accessing the data in betaturn$res_group_distance object,
correlation and regression analysis can be easily conducted with the trans_env class of microeco package.<br />
Ⅶ: Visualization: the ggplot2 object for the mode-“within_group = FALSE”.<br />
Ⅷ: Sample information table similar with Ⅲ.
In this example, “Region” column represents that the plants are collected from different regions.
It is used to show the mode-“within_group = TRUE”.<br />
Ⅸ: Converted table: similar with Ⅴ, but it is generated with the parameter “within_group = TRUE” in cal_group_distance function of betaturn class.
The table conversion is accomplished within each element of the “Region” column in Ⅷ for this study.
It can also be other column, such as “Plant_ID”.
Any two samples within an element of “Region” column will be combined.
Under such a circumstance,
by_group parameter is designed to generate the additional combinations related to the ‘Type’ and ‘Plant_ID’ columns in this study used for the following filtering.
So, in the mode-“within_group = TRUE”, the aim of by_group parameter is to create the combinations of groups as the table shows,
not to play a role of restriction of the by_group in the mode-“within_group = FALSE”.<br />
Ⅹ: Filtered table: similar with Ⅸ.
Here, the filtered table is an example to show the flexible manipulation on the converted table.
In this example, needless rows (combined by different plants) are deleted by customized operation in order to generate a final table for the following statistics and visualization.<br />
Ⅺ: Visualization: ggplot2 object for the mode-“within_group = TRUE”.<br />
(1): betaturn$new function with the parameter measure = “bray” (Bray-Curtis dissimilarity) or measure = “jaccard” (Jaccard dissimilarity).
Several beta diversity metrics are provided to obtain the distance matrix by creating betaturn object.<br />
(2): betaturn$new function with the parameter measure = “wei_unifrac”, “unwei_unifrac”, “betaMPD” or “betaMNTD”.
Several distance metrics of phylogenetic beta diversity require both the file Ⅰ and Ⅱ.<br />
(3): betaturn$new function with the parameter measure = “RCbray”. RCbray: Raup–Crick based Bray-Curtis dissimilarity.<br />
(4): betaturn$new function with the parameter measure = “betaNRI”, “betaNTI” or “ses_UniFrac”.<br />
Phylogenetic beta diversity, plus null model, can be used to obtain the standardized effect size of observed phylogenetic beta diversity.
betaNTI: beta nearest taxon index; betaNRI: beta net relatedness index; ses_UniFrac: standardized effect size of UniFrac distance.<br />
(5): betaturn$cal_group_distance(within_group = FALSE, …).
The distance matrix can be converted to a long format table according to the group classifications in Ⅲ.
The ‘Plant_ID’ (or other name) is used for guiding the file conversion in the mode-“within_group = FALSE” of Ⅴ.
The new ‘Type’ in Ⅴ is generated by combining paired plant compartments.<br />
(6): betaturn$cal_group_distance_diff function.
The differential test can be performed with several available approaches shown in the Ⅵ.<br />
(7): betaturn$plot_group_distance function.
The visualization is implemented based on R ggplo2 and ggpubr packages.
The differential test results in step (6) can be mapped to the plot automatically.<br />
(8): betaturn$cal_group_distance(within_group = TRUE, …).
This step is similar with step (5), but it is performed by the function cal_group_distance with the parameter “within_group = TRUE”.<br />
(9): customized manipulation on betaturn$res_group_distance file.
This step is to manipulate the file res_group_distance in the betaturn object and delete useless rows in the file according to the customized requirement.<br />
(10): Similar with step (6).<br />
(11): Similar with step (7).</p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="mecoturn-package.html#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mecoturn)</span>
<span id="cb346-2"><a href="mecoturn-package.html#cb346-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb346-3"><a href="mecoturn-package.html#cb346-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(wheat_16S)</span>
<span id="cb346-4"><a href="mecoturn-package.html#cb346-4" aria-hidden="true" tabindex="-1"></a><span class="co"># see the help document of betaturn</span></span>
<span id="cb346-5"><a href="mecoturn-package.html#cb346-5" aria-hidden="true" tabindex="-1"></a>?betaturn</span>
<span id="cb346-6"><a href="mecoturn-package.html#cb346-6" aria-hidden="true" tabindex="-1"></a><span class="co"># use &#39;bray&#39;, i.e. Bray-Curtis dissimilarity, as the example</span></span>
<span id="cb346-7"><a href="mecoturn-package.html#cb346-7" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> betaturn<span class="sc">$</span><span class="fu">new</span>(wheat_16S, <span class="at">measure =</span> <span class="st">&quot;bray&quot;</span>)</span></code></pre></div>
<pre><code>## The distance matrix is stored in object$beta_diversity list ...</code></pre>
<p>The matrix conversion is the core step in the betaturn class.
It has two cases: <code>within_group = TRUE</code> and <code>within_group = FALSE</code>.
The case <code>within_group = FALSE</code> means the distance conversion is carried out between any two elements of <code>Type</code> column (<code>group</code> parameter).
The parameter <code>by_group</code> is used to constrain the conversion, i.e. the conversion is performed for each plant.</p>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="mecoturn-package.html#cb348-1" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">cal_group_distance</span>(<span class="at">group =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">within_group =</span> <span class="cn">FALSE</span>, <span class="at">by_group =</span> <span class="st">&quot;Plant_ID&quot;</span>)</span></code></pre></div>
<pre><code>## The result is stored in object$res_group_distance ...</code></pre>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="mecoturn-package.html#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(b1<span class="sc">$</span>res_group_distance)</span></code></pre></div>
<pre><code>##       Value    Type          Plant_ID
## 1 0.7844286 S vs RS Northwest_Wheat_1
## 2 0.7922857 S vs RS Northwest_Wheat_2
## 3 0.6602857 S vs RS Northwest_Wheat_3
## 4 0.8028571 S vs RS Northwest_Wheat_4
## 5 0.7151429 S vs RS Northwest_Wheat_5
## 6 0.6704286 S vs RS      East_Wheat_1</code></pre>
<p>The combinations of <code>Type</code> may be not well-organized. We use <code>ordered_group</code> parameter to sort them and <code>sep</code> parameter to assign the direction.</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="mecoturn-package.html#cb352-1" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">cal_group_distance</span>(<span class="at">group =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">ordered_group =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;RS&quot;</span>, <span class="st">&quot;R&quot;</span>), <span class="at">within_group =</span> <span class="cn">FALSE</span>, <span class="at">by_group =</span> <span class="st">&quot;Plant_ID&quot;</span>, <span class="at">sep =</span> <span class="st">&quot; -&gt; &quot;</span>)</span></code></pre></div>
<pre><code>## The result is stored in object$res_group_distance ...</code></pre>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="mecoturn-package.html#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(b1<span class="sc">$</span>res_group_distance)</span></code></pre></div>
<pre><code>##       Value    Type          Plant_ID
## 1 0.7844286 S -&gt; RS Northwest_Wheat_1
## 2 0.7922857 S -&gt; RS Northwest_Wheat_2
## 3 0.6602857 S -&gt; RS Northwest_Wheat_3
## 4 0.8028571 S -&gt; RS Northwest_Wheat_4
## 5 0.7151429 S -&gt; RS Northwest_Wheat_5
## 6 0.6704286 S -&gt; RS      East_Wheat_1</code></pre>
<p>The <code>cal_group_distance_diff</code> function can be used to perform the statistical analysis.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="mecoturn-package.html#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wilcoxon rank sum test</span></span>
<span id="cb356-2"><a href="mecoturn-package.html#cb356-2" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">cal_group_distance_diff</span>(<span class="at">method =</span> <span class="st">&quot;wilcox&quot;</span>)</span>
<span id="cb356-3"><a href="mecoturn-package.html#cb356-3" aria-hidden="true" tabindex="-1"></a><span class="co"># paired Wilcoxon test by adding by_ID</span></span>
<span id="cb356-4"><a href="mecoturn-package.html#cb356-4" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">cal_group_distance_diff</span>(<span class="at">method =</span> <span class="st">&quot;wilcox&quot;</span>, <span class="at">by_ID =</span> <span class="st">&quot;Plant_ID&quot;</span>)</span>
<span id="cb356-5"><a href="mecoturn-package.html#cb356-5" aria-hidden="true" tabindex="-1"></a><span class="co"># box plot</span></span>
<span id="cb356-6"><a href="mecoturn-package.html#cb356-6" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">plot_group_distance</span>()</span></code></pre></div>
<p>The parameter <code>add_cols</code> can be used to add other columns in <code>sample_table</code> to the final table when <code>within_group = FALSE</code>.
This is especially useful when the statistical analysis will be performed for different groups.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="mecoturn-package.html#cb357-1" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">cal_group_distance</span>(<span class="at">group =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">ordered_group =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;RS&quot;</span>, <span class="st">&quot;R&quot;</span>), <span class="at">within_group =</span> <span class="cn">FALSE</span>, <span class="at">by_group =</span> <span class="st">&quot;Plant_ID&quot;</span>, <span class="at">sep =</span> <span class="st">&quot; -&gt; &quot;</span>, <span class="at">add_cols =</span> <span class="st">&quot;Region&quot;</span>)</span>
<span id="cb357-2"><a href="mecoturn-package.html#cb357-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(b1<span class="sc">$</span>res_group_distance)</span>
<span id="cb357-3"><a href="mecoturn-package.html#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Wilcoxon test for each region</span></span>
<span id="cb357-4"><a href="mecoturn-package.html#cb357-4" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">cal_group_distance_diff</span>(<span class="at">method =</span> <span class="st">&quot;wilcox&quot;</span>, <span class="at">by_group =</span> <span class="st">&quot;Region&quot;</span>)</span>
<span id="cb357-5"><a href="mecoturn-package.html#cb357-5" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">plot_group_distance</span>()</span></code></pre></div>
<p>Then let’s use linear mixed-effects model to check the random effects of plants.
For the usages of the <code>formula</code> in linear mixed-effects model (lme4 package), see <a href="https://mspeekenbrink.github.io/sdam-r-companion/linear-mixed-effects-models.html" class="uri">https://mspeekenbrink.github.io/sdam-r-companion/linear-mixed-effects-models.html</a></p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="mecoturn-package.html#cb358-1" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">cal_group_distance</span>(<span class="at">group =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">ordered_group =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;RS&quot;</span>, <span class="st">&quot;R&quot;</span>), <span class="at">within_group =</span> <span class="cn">FALSE</span>, <span class="at">by_group =</span> <span class="st">&quot;Plant_ID&quot;</span>, <span class="at">sep =</span> <span class="st">&quot; -&gt; &quot;</span>, <span class="at">add_cols =</span> <span class="st">&quot;Region&quot;</span>)</span>
<span id="cb358-2"><a href="mecoturn-package.html#cb358-2" aria-hidden="true" tabindex="-1"></a><span class="co"># random intercept and slope of Region</span></span>
<span id="cb358-3"><a href="mecoturn-package.html#cb358-3" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">cal_group_distance_diff</span>(<span class="at">method =</span> <span class="st">&quot;lme&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Type + (1 + Type| Region)&quot;</span>)</span>
<span id="cb358-4"><a href="mecoturn-package.html#cb358-4" aria-hidden="true" tabindex="-1"></a><span class="co"># random intercept of Plant_ID</span></span>
<span id="cb358-5"><a href="mecoturn-package.html#cb358-5" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">cal_group_distance_diff</span>(<span class="at">method =</span> <span class="st">&quot;lme&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Type + (1 | Plant_ID)&quot;</span>)</span>
<span id="cb358-6"><a href="mecoturn-package.html#cb358-6" aria-hidden="true" tabindex="-1"></a><span class="co"># random intercept of Plant_ID nested in Region</span></span>
<span id="cb358-7"><a href="mecoturn-package.html#cb358-7" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">cal_group_distance_diff</span>(<span class="at">method =</span> <span class="st">&quot;lme&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Type + (1 | Region/Plant_ID)&quot;</span>)</span>
<span id="cb358-8"><a href="mecoturn-package.html#cb358-8" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span>res_group_distance_diff</span></code></pre></div>
<p>Another case <code>within_group = TURE</code> means the distance conversion is performed according to each element of the group.
For example, when <code>group = "Region"</code>, any two samples within an element of <code>"Region"</code> column will be combined.
In this scenario, by_group parameter is designed to generate the additional combinations related to other columns.</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="mecoturn-package.html#cb359-1" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">cal_group_distance</span>(<span class="at">within_group =</span> <span class="cn">TRUE</span>, <span class="at">group =</span> <span class="st">&quot;Region&quot;</span>, <span class="at">by_group =</span> <span class="fu">c</span>(<span class="st">&quot;Type&quot;</span>, <span class="st">&quot;Plant_ID&quot;</span>))</span>
<span id="cb359-2"><a href="mecoturn-package.html#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(b1<span class="sc">$</span>res_group_distance)</span>
<span id="cb359-3"><a href="mecoturn-package.html#cb359-3" aria-hidden="true" tabindex="-1"></a><span class="co"># filter the combinations not coming from the same plant</span></span>
<span id="cb359-4"><a href="mecoturn-package.html#cb359-4" aria-hidden="true" tabindex="-1"></a>all_plants <span class="ot">&lt;-</span> <span class="fu">unique</span>(wheat_16S<span class="sc">$</span>sample_table<span class="sc">$</span>Plant_ID)</span>
<span id="cb359-5"><a href="mecoturn-package.html#cb359-5" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span>res_group_distance <span class="sc">%&lt;&gt;%</span> .[.<span class="sc">$</span>Plant_ID <span class="sc">%in%</span> <span class="fu">paste0</span>(all_plants, <span class="st">&quot; vs &quot;</span>, all_plants), ]</span>
<span id="cb359-6"><a href="mecoturn-package.html#cb359-6" aria-hidden="true" tabindex="-1"></a><span class="co"># compare values across regions</span></span>
<span id="cb359-7"><a href="mecoturn-package.html#cb359-7" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">cal_group_distance_diff</span>(<span class="at">method =</span> <span class="st">&quot;anova&quot;</span>)</span>
<span id="cb359-8"><a href="mecoturn-package.html#cb359-8" aria-hidden="true" tabindex="-1"></a>b1<span class="sc">$</span><span class="fu">plot_group_distance</span>(<span class="at">add_sig_text_size =</span> <span class="fl">5.6</span>, <span class="at">xtext_angle =</span> <span class="dv">30</span>)</span></code></pre></div>
</div>
<div id="taxaturn-class" class="section level2 hasAnchor" number="13.2">
<h2><span class="header-section-number">13.2</span> taxaturn class<a href="mecoturn-package.html#taxaturn-class" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The taxaturn class refers to microbial abundance change along a gradient.
Its workflow includes the taxonomic abundance calculation, abundance transformation, abundance change summary, statistical analysis and visualization.</p>
<p><img src="Images/mecoturn_taxaturn.png" width="1000px" style="display: block; margin: auto;" /></p>
<p>The core of this workflow is the abundance change summary and statistical analysis,
which can be classified into two cases: by_ID = NULL and by_ID = “Plant_ID” in the example (step 1 or 4, and step 8 in the Figure).<br />
Ⅰ: Taxonomic abundance table: the table (data.frame format) in microtable$taxa_abund list.
It denotes taxonomic abundance table with the data.frame format at a specific taxonomic level.<br />
Ⅱ: Sample information table: the sample metadata, i.e. sample_table in microtable object.
The ‘Type’ column represents the plant compartments or other ordered groups used for the following comparisons.
The ‘Plant_ID’ column denotes each plant, which can guide the comparison of abundances for each plant when by_ID = “Plant_ID”.
“Region” column is used for the cases with by_group = “Region”.<br />
Ⅲ: Summarized abundance: taxaturn$res_abund object.
This summarized abundance table is converted under the condition of by_ID = NULL and by_group = NULL.
Under this condition, the abundance is summarized by the groups of “Type” column of Ⅱ in order to generate ‘Mean’ and ‘SD’ in the result (mean and standard deviation of each group).
‘N’ is the sample number in each group.<br />
Ⅳ: Abundance change table: res_change_pair (the upper one) and res_change (the table below) in the taxaturn object.
The change pattern along the ordered groups is generated according to the mean abundance in Ⅲ for each taxon.
The res_change_pair table has all paired abundance difference values between two neighboring niches for each taxon (the abundance of the latter minus that of the former).
The res_change is the following summary information of difference values along ordered paired groups in res_change_pair table.
In res_change table, there are three types of changes: ‘Increase’, ‘Decrease’ and others (fluctuation with the combination of ‘+’, ‘-’ or ‘0’,
or nothing when no consistent result is obtained across plants).<br />
Ⅴ: Statistical analysis.
The approaches include beta regression model and differential abundance test between two groups.
The differential abundance test is designed for the comparison of two groups,
such as differential test between S and RS or between RS and R.
There are two implemented approaches: t-Test and Wilcoxon Rank Sum Test.<br />
Ⅵ: Summarized abundance. Similar with Ⅲ, but the Mean and SD are performed by both the group (‘Type’) and by_group (‘Region’). So N is less than that in Ⅲ.<br />
Ⅶ: Abundance change table. Similar with Ⅳ, but the ‘change’ trend is summarized for different regions, respectively.<br />
Ⅷ: Summarized abundance. As by_ID is provided (“Plant_ID”), the N is 1. The Mean is the abundance of each sample of each plant. SD is not available (NA).<br />
Ⅸ: Abundance change table: res_change_pair (the upper one) and res_change (the table below) in the taxaturn object.
The res_change_pair is a little different from that in Ⅳ, because it is calculated for each individual plant.
So the table has a column named by_ID (“Plant_ID”).
This table is particularly useful for the association between abundance difference values and environmental factors.
The res_change table is the summary result of res_change_pair table.
For the case ‘by_group = NULL’, the data in res_change is the consistent abundance comparison along ordered groups and across all the plants.<br />
Ⅹ: Abundance change table.
Different from the res_change table of Ⅸ, the res_change table in Ⅹ is generated according to the by_group (‘Region’).
So the result is the consistent abundance comparisons along ordered groups within each region.
Note that the res_change_pair table is not shown here as it is same with res_change_pair in Ⅸ,
because the parameter by_group = “Region” only affects the change summary result.<br />
Ⅺ: Statistical analysis. Different from Ⅴ, some approaches for this case (by_ID is provided) necessitates consideration of the paired data,
such as paired t-Test and paired Wilcoxon Rank Sum Test. The input data will be first sorted by the elements in “Plant_ID” column of Ⅱ.
The linear mixed-effects model can be used to test the random effects of plant individuals similar with the Ⅵ.
To better fit the relative abundance (bounded by 0 and 1),
the family function of generalized linear mixed model (GLMM) in taxaturn class is fixed with the beta distribution function, and the link function is “logit” function.
The correlation and regression analysis can be performed by means of the trans_env class of microeco package.<br />
(1) and (2): taxaturn$new function. The parameter by_ID = NULL and by_group = NULL is applied in this example.
Creating taxaturn object can generate Ⅲ (i.e. res_abund) in the object.
If the taxonomic abundance (i.e. taxa_abund list) in the input microtable object is NULL,
the function can automatically invoke the cal_abund function in microtable object to calculate it.<br />
Creating taxaturn object can also create Ⅳ (i.e. res_change_pair and res_change) in the object.<br />
(3): taxaturn$cal_diff function. The cal_diff function in taxaturn class is designed to perform the differential test.<br />
(4) and (5): taxaturn$new function. Similar with step (1). The parameter by_ID = NULL and by_group = “Region” is used in this example.<br />
(6): Similar with step (3).<br />
(7): taxaturn$plot function. The plot function in taxaturn class is used to plot the abundance along ordered groups and generate a ggplot2 object.<br />
(8) and (9): taxaturn$new function with the parameter by_ID = “Plant_ID” and by_group = NULL.<br />
(10): taxaturn$cal_diff function. For the case that by_ID parameter is provided,
the differential abundance test between two groups are designed for the paired data.<br />
(8) and (11): taxaturn$new function with the parameter by_ID = “Plant_ID” and by_group = “Region”.<br />
(12): Similar with step (10).<br />
(13): Similar with step (7). For the case that by_ID parameter is provided, abundance visualization is performed for each element of by_ID parameter,
i.e. each plant individual in this example.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="mecoturn-package.html#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># study the abundance change of phyla by comparing the mean abundances without the consideration of plants</span></span>
<span id="cb360-2"><a href="mecoturn-package.html#cb360-2" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> taxaturn<span class="sc">$</span><span class="fu">new</span>(wheat_16S, <span class="at">taxa_level =</span> <span class="st">&quot;Phylum&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">ordered_group =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;RS&quot;</span>, <span class="st">&quot;R&quot;</span>), <span class="at">by_ID =</span> <span class="cn">NULL</span>, <span class="at">by_group =</span> <span class="cn">NULL</span>, <span class="at">filter_thres =</span> <span class="fl">0.001</span>)</span></code></pre></div>
<pre><code>## Taxa abundance data is stored in object$res_abund ...</code></pre>
<pre><code>## Abundance change along groups is stored in object$res_change_pair ...</code></pre>
<pre><code>## Abundance change summary is stored in object$res_change ...</code></pre>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="mecoturn-package.html#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(t1<span class="sc">$</span>res_change)</span></code></pre></div>
<pre><code>##                             Taxa    Direction   Change
## 1   k__Archaea|p__Thaumarchaeota S -&gt; RS -&gt; R Decrease
## 2   k__Bacteria|p__Acidobacteria S -&gt; RS -&gt; R Decrease
## 3  k__Bacteria|p__Actinobacteria S -&gt; RS -&gt; R Increase
## 4 k__Bacteria|p__Armatimonadetes S -&gt; RS -&gt; R Decrease
## 5   k__Bacteria|p__Bacteroidetes S -&gt; RS -&gt; R      +|-
## 6     k__Bacteria|p__Chloroflexi S -&gt; RS -&gt; R Decrease</code></pre>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="mecoturn-package.html#cb366-1" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">cal_diff</span>(<span class="at">method =</span> <span class="st">&quot;wilcox&quot;</span>, <span class="at">p_adjust_method =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<pre><code>## Raw differential test results are stored in object$res_diff_raw ...</code></pre>
<pre><code>## Differential test results have been added into object$res_change ...</code></pre>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="mecoturn-package.html#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(t1<span class="sc">$</span>res_change)</span></code></pre></div>
<pre><code>##                             Taxa    Direction   Change S -&gt; RS | Significance
## 1   k__Archaea|p__Thaumarchaeota S -&gt; RS -&gt; R Decrease                    ***
## 2   k__Bacteria|p__Acidobacteria S -&gt; RS -&gt; R Decrease                    ***
## 3  k__Bacteria|p__Actinobacteria S -&gt; RS -&gt; R Increase                     ns
## 4 k__Bacteria|p__Armatimonadetes S -&gt; RS -&gt; R Decrease                      *
## 5   k__Bacteria|p__Bacteroidetes S -&gt; RS -&gt; R      +|-                     ns
## 6     k__Bacteria|p__Chloroflexi S -&gt; RS -&gt; R Decrease                     **
##   RS -&gt; R | Significance
## 1                    ***
## 2                    ***
## 3                     **
## 4                     **
## 5                     ns
## 6                    ***</code></pre>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="mecoturn-package.html#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare the abundance change by summarizing the results for each plant individual</span></span>
<span id="cb371-2"><a href="mecoturn-package.html#cb371-2" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> taxaturn<span class="sc">$</span><span class="fu">new</span>(wheat_16S, <span class="at">taxa_level =</span> <span class="st">&quot;Phylum&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">ordered_group =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;RS&quot;</span>, <span class="st">&quot;R&quot;</span>), <span class="at">by_ID =</span> <span class="st">&quot;Plant_ID&quot;</span>, <span class="at">by_group =</span> <span class="cn">NULL</span>, <span class="at">filter_thres =</span> <span class="fl">0.001</span>)</span></code></pre></div>
<pre><code>## Taxa abundance data is stored in object$res_abund ...</code></pre>
<pre><code>## Abundance change along groups is stored in object$res_change_pair ...</code></pre>
<pre><code>## Abundance change summary is stored in object$res_change ...</code></pre>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="mecoturn-package.html#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(t1<span class="sc">$</span>res_change)</span></code></pre></div>
<pre><code>##                             Taxa    Direction   Change
## 1   k__Archaea|p__Thaumarchaeota S -&gt; RS -&gt; R         
## 2   k__Bacteria|p__Acidobacteria S -&gt; RS -&gt; R Decrease
## 3  k__Bacteria|p__Actinobacteria S -&gt; RS -&gt; R         
## 4 k__Bacteria|p__Armatimonadetes S -&gt; RS -&gt; R         
## 5   k__Bacteria|p__Bacteroidetes S -&gt; RS -&gt; R         
## 6     k__Bacteria|p__Chloroflexi S -&gt; RS -&gt; R</code></pre>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="mecoturn-package.html#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="co"># paired Wilcoxon test</span></span>
<span id="cb377-2"><a href="mecoturn-package.html#cb377-2" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">cal_diff</span>(<span class="at">method =</span> <span class="st">&quot;wilcox&quot;</span>, <span class="at">p_adjust_method =</span> <span class="cn">NULL</span>)</span></code></pre></div>
<pre><code>## Raw differential test results are stored in object$res_diff_raw ...</code></pre>
<pre><code>## Differential test results have been added into object$res_change ...</code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="mecoturn-package.html#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(t1<span class="sc">$</span>res_change)</span></code></pre></div>
<pre><code>##                             Taxa    Direction   Change S -&gt; RS | Significance
## 1   k__Archaea|p__Thaumarchaeota S -&gt; RS -&gt; R                             ***
## 2   k__Bacteria|p__Acidobacteria S -&gt; RS -&gt; R Decrease                    ***
## 3  k__Bacteria|p__Actinobacteria S -&gt; RS -&gt; R                              ns
## 4 k__Bacteria|p__Armatimonadetes S -&gt; RS -&gt; R                              **
## 5   k__Bacteria|p__Bacteroidetes S -&gt; RS -&gt; R                               *
## 6     k__Bacteria|p__Chloroflexi S -&gt; RS -&gt; R                             ***
##   RS -&gt; R | Significance
## 1                    ***
## 2                    ***
## 3                     **
## 4                    ***
## 5                     ns
## 6                    ***</code></pre>
<p>The upper operations can also be applied to different groups.</p>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="mecoturn-package.html#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for each region without the consideration of plants</span></span>
<span id="cb382-2"><a href="mecoturn-package.html#cb382-2" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> taxaturn<span class="sc">$</span><span class="fu">new</span>(wheat_16S, <span class="at">taxa_level =</span> <span class="st">&quot;Phylum&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">ordered_group =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;RS&quot;</span>, <span class="st">&quot;R&quot;</span>), <span class="at">by_ID =</span> <span class="cn">NULL</span>, <span class="at">by_group =</span> <span class="st">&quot;Region&quot;</span>, <span class="at">filter_thres =</span> <span class="fl">0.001</span>)</span>
<span id="cb382-3"><a href="mecoturn-package.html#cb382-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(t1<span class="sc">$</span>res_change)</span>
<span id="cb382-4"><a href="mecoturn-package.html#cb382-4" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">cal_diff</span>(<span class="at">method =</span> <span class="st">&quot;wilcox&quot;</span>, <span class="at">p_adjust_method =</span> <span class="cn">NULL</span>)</span>
<span id="cb382-5"><a href="mecoturn-package.html#cb382-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(t1<span class="sc">$</span>res_change)</span>
<span id="cb382-6"><a href="mecoturn-package.html#cb382-6" aria-hidden="true" tabindex="-1"></a><span class="co"># for each region with the consideration of plants</span></span>
<span id="cb382-7"><a href="mecoturn-package.html#cb382-7" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> taxaturn<span class="sc">$</span><span class="fu">new</span>(wheat_16S, <span class="at">taxa_level =</span> <span class="st">&quot;Phylum&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">ordered_group =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;RS&quot;</span>, <span class="st">&quot;R&quot;</span>), <span class="at">by_ID =</span> <span class="st">&quot;Plant_ID&quot;</span>, <span class="at">by_group =</span> <span class="st">&quot;Region&quot;</span>, <span class="at">filter_thres =</span> <span class="fl">0.001</span>)</span>
<span id="cb382-8"><a href="mecoturn-package.html#cb382-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(t1<span class="sc">$</span>res_change)</span>
<span id="cb382-9"><a href="mecoturn-package.html#cb382-9" aria-hidden="true" tabindex="-1"></a><span class="co"># paired Wilcoxon test</span></span>
<span id="cb382-10"><a href="mecoturn-package.html#cb382-10" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">cal_diff</span>(<span class="at">method =</span> <span class="st">&quot;wilcox&quot;</span>, <span class="at">p_adjust_method =</span> <span class="cn">NULL</span>)</span>
<span id="cb382-11"><a href="mecoturn-package.html#cb382-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(t1<span class="sc">$</span>res_change)</span>
<span id="cb382-12"><a href="mecoturn-package.html#cb382-12" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">plot</span>(<span class="at">point_size =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>Then let’s show the linear mixed-effects model to analyze both the fixed and random effects.</p>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="mecoturn-package.html#cb383-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> taxaturn<span class="sc">$</span><span class="fu">new</span>(wheat_16S, <span class="at">taxa_level =</span> <span class="st">&quot;Phylum&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">ordered_group =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;RS&quot;</span>, <span class="st">&quot;R&quot;</span>), <span class="at">by_ID =</span> <span class="st">&quot;Plant_ID&quot;</span>, <span class="at">by_group =</span> <span class="st">&quot;Region&quot;</span>)</span>
<span id="cb383-2"><a href="mecoturn-package.html#cb383-2" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">cal_diff</span>(<span class="at">method =</span> <span class="st">&quot;lme&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Type + (1 + Type | Region)&quot;</span>, <span class="at">measure =</span> <span class="st">&quot;p__Proteobacteria&quot;</span>)</span>
<span id="cb383-3"><a href="mecoturn-package.html#cb383-3" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span>res_diff</span></code></pre></div>
<p>For the relative abundance fitting, common parametric tests like anova is not a good way since the dependent variable is proportion data,
which is not normally distributed or homoscedastic generally.
Beta regression is suitable for the proportion data (bound at 0 and 1) <span class="citation">(<a href="#ref-Douma_Analysing_2019" role="doc-biblioref">Douma, Weedon, and Warton 2019</a>)</span>.
This method is implemented based on the betareg package <span class="citation">(<a href="#ref-Betaregression_2010" role="doc-biblioref">Cribari-Neto and Zeileis 2010</a>)</span>.</p>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="mecoturn-package.html#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for all samples</span></span>
<span id="cb384-2"><a href="mecoturn-package.html#cb384-2" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> taxaturn<span class="sc">$</span><span class="fu">new</span>(wheat_16S, <span class="at">taxa_level =</span> <span class="st">&quot;Phylum&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">ordered_group =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;RS&quot;</span>, <span class="st">&quot;R&quot;</span>), <span class="at">by_ID =</span> <span class="st">&quot;Plant_ID&quot;</span>, <span class="at">by_group =</span> <span class="cn">NULL</span>, <span class="at">filter_thres =</span> <span class="fl">0.001</span>)</span>
<span id="cb384-3"><a href="mecoturn-package.html#cb384-3" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">cal_diff</span>(<span class="at">method =</span> <span class="st">&quot;betareg&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Type&quot;</span>)</span>
<span id="cb384-4"><a href="mecoturn-package.html#cb384-4" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span>res_diff</span></code></pre></div>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="mecoturn-package.html#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for different regions</span></span>
<span id="cb385-2"><a href="mecoturn-package.html#cb385-2" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> taxaturn<span class="sc">$</span><span class="fu">new</span>(wheat_16S, <span class="at">taxa_level =</span> <span class="st">&quot;Phylum&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">ordered_group =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;RS&quot;</span>, <span class="st">&quot;R&quot;</span>), <span class="at">by_ID =</span> <span class="st">&quot;Plant_ID&quot;</span>, <span class="at">by_group =</span> <span class="st">&quot;Region&quot;</span>, <span class="at">filter_thres =</span> <span class="fl">0.001</span>)</span>
<span id="cb385-3"><a href="mecoturn-package.html#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="co"># measure can be assigned with a taxon</span></span>
<span id="cb385-4"><a href="mecoturn-package.html#cb385-4" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">cal_diff</span>(<span class="at">method =</span> <span class="st">&quot;betareg&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">measure =</span> <span class="st">&quot;p__Proteobacteria&quot;</span>)</span>
<span id="cb385-5"><a href="mecoturn-package.html#cb385-5" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span>res_diff</span>
<span id="cb385-6"><a href="mecoturn-package.html#cb385-6" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">plot</span>(<span class="at">point_size =</span> <span class="dv">2</span>, <span class="at">select_taxon =</span> <span class="st">&quot;p__Proteobacteria&quot;</span>, <span class="at">plot_type =</span> <span class="fu">c</span>(<span class="st">&quot;point&quot;</span>, <span class="st">&quot;smooth&quot;</span>), <span class="at">rect_fill =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>When both the random effects and beta distribution fitting are considered in the model,
generalized linear mixed model can be employed with the family function beta distribution function.</p>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="mecoturn-package.html#cb386-1" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">&lt;-</span> taxaturn<span class="sc">$</span><span class="fu">new</span>(wheat_16S, <span class="at">taxa_level =</span> <span class="st">&quot;Phylum&quot;</span>, <span class="at">group =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">ordered_group =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;RS&quot;</span>, <span class="st">&quot;R&quot;</span>), <span class="at">filter_thres =</span> <span class="fl">0.001</span>)</span>
<span id="cb386-2"><a href="mecoturn-package.html#cb386-2" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">cal_diff</span>(<span class="at">method =</span> <span class="st">&quot;glmm&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Type + (1|Region)&quot;</span>, <span class="at">return_model =</span> <span class="cn">TRUE</span>, <span class="at">group2num =</span> <span class="cn">TRUE</span>)</span>
<span id="cb386-3"><a href="mecoturn-package.html#cb386-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(t1<span class="sc">$</span>res_diff)</span>
<span id="cb386-4"><a href="mecoturn-package.html#cb386-4" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the original models</span></span>
<span id="cb386-5"><a href="mecoturn-package.html#cb386-5" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> t1<span class="sc">$</span>res_model</span>
<span id="cb386-6"><a href="mecoturn-package.html#cb386-6" aria-hidden="true" tabindex="-1"></a><span class="co"># without the random effect term</span></span>
<span id="cb386-7"><a href="mecoturn-package.html#cb386-7" aria-hidden="true" tabindex="-1"></a>t1<span class="sc">$</span><span class="fu">cal_diff</span>(<span class="at">method =</span> <span class="st">&quot;glmm&quot;</span>, <span class="at">formula =</span> <span class="st">&quot;Type&quot;</span>, <span class="at">return_model =</span> <span class="cn">TRUE</span>, <span class="at">group2num =</span> <span class="cn">TRUE</span>)</span>
<span id="cb386-8"><a href="mecoturn-package.html#cb386-8" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> t1<span class="sc">$</span>res_model</span>
<span id="cb386-9"><a href="mecoturn-package.html#cb386-9" aria-hidden="true" tabindex="-1"></a><span class="co"># use anova to compare models</span></span>
<span id="cb386-10"><a href="mecoturn-package.html#cb386-10" aria-hidden="true" tabindex="-1"></a><span class="co"># names(m1)[1]: p__Proteobacteria</span></span>
<span id="cb386-11"><a href="mecoturn-package.html#cb386-11" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1[[<span class="dv">1</span>]], m2[[<span class="dv">1</span>]])</span></code></pre></div>

</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Anderson_Navigating_2011" class="csl-entry">
Anderson, M. J., T. O. Crist, J. M. Chase, M. Vellend, B. D. Inouye, A. L. Freestone, N. J. Sanders, et al. 2011. <span>“Navigating the Multiple Meanings of Beta Diversity: A Roadmap for the Practicing Ecologist.”</span> Journal Article. <em>Ecology Letters</em> 14 (1): 19–28. <a href="https://doi.org/10.1111/j.1461-0248.2010.01552.x">https://doi.org/10.1111/j.1461-0248.2010.01552.x</a>.
</div>
<div id="ref-Betaregression_2010" class="csl-entry">
Cribari-Neto, Francisco, and Achim Zeileis. 2010. <span>“Beta Regression in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 34 (2): 1–24. <a href="https://doi.org/10.18637/jss.v034.i02">https://doi.org/10.18637/jss.v034.i02</a>.
</div>
<div id="ref-Douma_Analysing_2019" class="csl-entry">
Douma, Jacob C., James T. Weedon, and David Warton. 2019. <span>“<span class="nocase">Analysing continuous proportions in ecology and evolution: A practical introduction to beta and Dirichlet regression</span>.”</span> Journal Article. <em>Methods in Ecology and Evolution</em> 10 (9): 1412–30. <a href="https://doi.org/10.1111/2041-210x.13234">https://doi.org/10.1111/2041-210x.13234</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="mecodev-package.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="other-examples-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/12-mecoturn.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["microeco-tutorial.pdf", "microeco-tutorial.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
